<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TaskHub</title>

<style>
body{
 font-family:Arial;
 background:#0f172a;
 color:white;
 text-align:center;
}

/* BOX */
.box{
 background:#1e293b;
 padding:25px;
 margin:30px auto;
 width:360px;
 border-radius:14px;
 box-shadow:0 0 25px #0006;
}

/* HELLO */
.hello{
 font-size:22px;
 font-weight:bold;
 background:linear-gradient(90deg,#22c55e,#38bdf8);
 -webkit-background-clip:text;
 color:transparent;
 margin-bottom:10px;
}

/* BUTTON */
button{
 padding:10px;
 margin:6px;
 border:none;
 border-radius:8px;
 background:#22c55e;
 color:white;
 cursor:pointer;
 font-weight:bold;
}

button:hover{
 background:#16a34a;
}

.logout{
 background:#ef4444;
}

.musicBtn{
 background:#38bdf8;
}

input{
 padding:10px;
 margin:6px;
 width:90%;
 border-radius:6px;
 border:none;
}

/* POPUP */
#withdrawBox{
 position:fixed;
 top:0;
 left:0;
 width:100%;
 height:100%;
 background:rgba(0,0,0,0.7);
 display:none;
 justify-content:center;
 align-items:center;
}

.popup{
 background:#1e293b;
 padding:25px;
 border-radius:12px;
 width:340px;
}
</style>
</head>

<body>

<h1>ğŸ’° TaskHub</h1>

<!-- AUDIO -->
<audio id="bgMusic" loop>
<source src="music.mp3" type="audio/mpeg">
</audio>

<!-- LOGIN -->
<div id="auth" class="box">
<h3>ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h3>

<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">

<br>
<button onclick="register()">ÄÄƒng kÃ½</button>
<button onclick="login()">ÄÄƒng nháº­p</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="box" style="display:none">

<div class="hello">
ğŸ‘‹ Xin chÃ o <span id="name">User</span> !
</div>

<p>Sá»‘ dÆ°: <b id="money">0</b>Ä‘</p>

<button onclick="taoTask()">ğŸ§© LÃ m nhiá»‡m vá»¥ (+200Ä‘)</button>
<button onclick="rutTien()">ğŸ’¸ RÃºt tiá»n</button>
<button onclick="toggleMusic()" class="musicBtn">ğŸµ Báº­t/Táº¯t nháº¡c</button>
<button class="logout" onclick="logout()">ÄÄƒng xuáº¥t</button>

<p id="status"></p>

</div>

<!-- POPUP RÃšT TIá»€N -->
<div id="withdrawBox">
 <div class="popup">

   <h3>ğŸ’¸ RÃºt tiá»n</h3>

   <p>âœ… Há»— trá»£ rÃºt qua:</p>
   <p>ğŸ“± Tháº» cÃ o (Viettel / Mobi / Vina)</p>
   <p>ğŸ¦ Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng</p>

   <hr>

   <p>ğŸ‘‰ IB Facebook Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£ rÃºt:</p>

   <button onclick="openFB()">ğŸ“© IB Admin</button>
   <br><br>
   <button onclick="closeWithdraw()">ÄÃ³ng</button>

 </div>
</div>

<script>

/* ========= AUTH ========= */

function register(){
 let u=document.getElementById("user").value.trim();
 let p=document.getElementById("pass").value.trim();

 if(!u||!p) return alert("Nháº­p Ä‘á»§ thÃ´ng tin");

 localStorage.setItem("acc_"+u,p);
 alert("âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng");
}

function login(){
 let u=user.value;
 let p=pass.value;

 if(localStorage.getItem("acc_"+u)==p){
   localStorage.setItem("login",u);
   start();
 }else alert("Sai tÃ i khoáº£n");
}

function logout(){
 localStorage.removeItem("login");
 location.reload();
}

function start(){
 let u=localStorage.getItem("login");
 if(!u) return;

 document.getElementById("auth").style.display="none";
 document.getElementById("dashboard").style.display="block";

 document.getElementById("name").innerText=u;

 document.getElementById("money").innerText =
 localStorage.getItem("money_"+u)||0;
}
start();

/* ========= TASK ========= */

async function taoTask(){

 let user = localStorage.getItem("login");
 if(!user) return alert("ChÆ°a Ä‘Äƒng nháº­p");

 status.innerText="â³ Äang táº¡o nhiá»‡m vá»¥...";

 let taskLink =
 location.origin +
 "/task.html?user="+user;

 try{

   let res=await fetch(
     "/api/short?url="+encodeURIComponent(taskLink)
   );

   let data=await res.json();

   if(!data.short){
     status.innerText="âŒ Lá»—i API";
     return;
   }

   status.innerText="âœ… Äang má»Ÿ nhiá»‡m vá»¥...";

   window.open(data.short,"_blank");

 }catch{
   status.innerText="âŒ Server lá»—i";
 }

}

/* ========= MUSIC ========= */

const music=document.getElementById("bgMusic");
let playing=false;

function toggleMusic(){

 if(!playing){
   music.volume=0.4;
   music.play();
   playing=true;
 }else{
   music.pause();
   playing=false;
 }

}

/* ========= RÃšT TIá»€N ========= */

function rutTien(){
 withdrawBox.style.display="flex";
}

function closeWithdraw(){
 withdrawBox.style.display="none";
}

function openFB(){
 window.open(
 "https://www.facebook.com/profile.php?id=61555922620631",
 "_blank"
 );
}

</script>

</body>
</html>
