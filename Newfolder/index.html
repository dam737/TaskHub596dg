<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TaskHub</title>
<style>
body{font-family:Arial;background:#0f172a;color:white;text-align:center}
.box{background:#1e293b;padding:20px;margin:20px auto;width:350px;border-radius:10px}
button{padding:10px;margin:5px;border:none;border-radius:6px;background:#22c55e;color:white}
input{padding:10px;margin:5px;width:90%}
</style>
</head>

<body>

<h1>ğŸ’° TaskHub</h1>

<div id="auth" class="box">
<h3>ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h3>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<br>
<button onclick="register()">ÄÄƒng kÃ½</button>
<button onclick="login()">ÄÄƒng nháº­p</button>
</div>

<div id="dashboard" class="box" style="display:none">
<h3>Xin chÃ o <span id="name"></span></h3>
<p>Sá»‘ dÆ°: <b id="money">0</b>Ä‘</p>

<button onclick="taoTask()">ğŸ§© LÃ m nhiá»‡m vá»¥</button>
<button onclick="rutTien()">ğŸ’¸ RÃºt tiá»n</button>

<div id="tasklink"></div>
</div>

<script>
function saveUser(u,p){
 localStorage.setItem("acc_"+u,p);
}

function register(){
 let u=user.value;
 let p=pass.value;
 saveUser(u,p);
 alert("ÄÄƒng kÃ½ thÃ nh cÃ´ng");
}

function login(){
 let u=user.value;
 let p=pass.value;

 if(localStorage.getItem("acc_"+u)==p){
   localStorage.setItem("login",u);
   start();
 }else alert("Sai tÃ i khoáº£n");
}

function start(){
 let u=localStorage.getItem("login");
 if(!u) return;

 auth.style.display="none";
 dashboard.style.display="block";
 name.innerText=u;
 money.innerText=localStorage.getItem("money_"+u)||0;
}
start();

function randomID(){
 return crypto.randomUUID().replaceAll("-","")+Date.now();
}

async function taoTask(){

 let id=randomID();

 // link nhiá»‡m vá»¥ cuá»‘i
 let final="https://google.com";

 // gá»i API YeuMoney
 let r=await fetch(`/api/short?url=${encodeURIComponent(location.origin+"/task.html?id="+id+"&url="+final)}`);
 let d=await r.json();

 tasklink.innerHTML=
 `<p>Link nhiá»‡m vá»¥:</p>
 <a href="${d.short}" target="_blank">${d.short}</a>`;
}

function rutTien(){
 window.open(
 "https://www.facebook.com/profile.php?id=61555922620631",
 "_blank"
 );
}
</script>

</body>
</html>
