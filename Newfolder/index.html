<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TaskHub</title>

<style>
body{
  font-family:Arial;
  background:#0f172a;
  color:white;
  text-align:center;
}

.box{
  background:#1e293b;
  padding:20px;
  margin:20px auto;
  width:360px;
  border-radius:12px;
}

button{
  padding:10px;
  margin:6px;
  border:none;
  border-radius:6px;
  background:#22c55e;
  color:white;
  cursor:pointer;
}

input{
  padding:10px;
  margin:5px;
  width:90%;
}

#withdrawBox{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.7);
  display:none;
  justify-content:center;
  align-items:center;
}

.popup{
  background:#1e293b;
  padding:25px;
  border-radius:12px;
  width:350px;
}
</style>
</head>

<body>

<h1>ğŸ’° TaskHub</h1>

<!-- LOGIN -->
<div id="auth" class="box">
<h3>ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h3>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password"><br>

<button onclick="register()">ÄÄƒng kÃ½</button>
<button onclick="login()">ÄÄƒng nháº­p</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="box" style="display:none">
<h3>Xin chÃ o <span id="name"></span></h3>
<p>Sá»‘ dÆ°: <b id="money">0</b>Ä‘</p>

<button onclick="taoTask()">ğŸ§© LÃ m nhiá»‡m vá»¥</button>
<button onclick="rutTien()">ğŸ’¸ RÃºt tiá»n</button>

<p id="status"></p>
</div>

<!-- POPUP RÃšT TIá»€N -->
<div id="withdrawBox">
  <div class="popup">

    <h3>ğŸ’¸ YÃªu cáº§u rÃºt tiá»n</h3>

    <p>Há»— trá»£ rÃºt qua:</p>

    <p>ğŸ¦ Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng</p>
    <p>ğŸ“± Tháº» cÃ o (Viettel / Mobi / Vina)</p>

    <hr>

    <p>ğŸ‘‰ Nháº¯n tin Facebook Ä‘á»ƒ rÃºt tiá»n</p>

    <button onclick="openFB()">ğŸ“© IB Admin</button>
    <br><br>
    <button onclick="closeWithdraw()">ÄÃ³ng</button>

  </div>
</div>

<script>

/* ================= LOGIN ================= */

function saveUser(u,p){
 localStorage.setItem("acc_"+u,p);
}

function register(){
 let u=user.value.trim();
 let p=pass.value.trim();

 if(!u || !p){
   alert("Nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin");
   return;
 }

 saveUser(u,p);
 alert("âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng");
}

function login(){
 let u=user.value;
 let p=pass.value;

 if(localStorage.getItem("acc_"+u)==p){
   localStorage.setItem("login",u);
   start();
 }else alert("Sai tÃ i khoáº£n");
}

function start(){
 let u=localStorage.getItem("login");
 if(!u) return;

 auth.style.display="none";
 dashboard.style.display="block";

 name.innerText=u;
 money.innerText=localStorage.getItem("money_"+u)||0;
}
start();

/* ================= TASK ================= */

function randomID(){
 return crypto.randomUUID().replaceAll("-","")+Date.now();
}

async function taoTask(){

 let user = localStorage.getItem("login");
 if(!user){
   alert("Vui lÃ²ng Ä‘Äƒng nháº­p!");
   return;
 }

 status.innerText="â³ Äang táº¡o nhiá»‡m vá»¥...";

 let id=randomID();

 let final="https://google.com";

 let taskURL =
 location.origin +
 "/task.html?id="+id+
 "&url="+encodeURIComponent(final);

 try{

   let r=await fetch(
     `/api/short?url=${encodeURIComponent(taskURL)}`
   );

   let d=await r.json();

   if(!d.short){
     status.innerText="âŒ Lá»—i táº¡o nhiá»‡m vá»¥";
     return;
   }

   status.innerText="âœ… Äang má»Ÿ nhiá»‡m vá»¥...";

   // ğŸ”¥ tá»± má»Ÿ YeuMoney
   window.open(d.short,"_blank");

 }catch{
   status.innerText="âŒ Server lá»—i";
 }
}

/* ================= RÃšT TIá»€N ================= */

function rutTien(){
 withdrawBox.style.display="flex";
}

function closeWithdraw(){
 withdrawBox.style.display="none";
}

function openFB(){
 window.open(
 "https://www.facebook.com/profile.php?id=61555922620631",
 "_blank"
 );
}

</script>

</body>
</html>
